<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- $Id$ -->

<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>JATSPAN Release Procedure</title>
    <link rel='stylesheet' href="style/article.css"/>
    <link rel="shortcut icon" type="image/png" href="style/jatspan-icon.png" />
  </head>

  <body>
    <h1>JATSPAN Release Procedure</h1>
    <div class='sec'>
      <p>
        This documents the procedure to be followed to create a new
        release bundle of the core JATSPacks, which include the NLM DTDs
        and the new NISO JATS version 0.4.
      </p>
      <ol class='long'>
        <li>
          In the trunk directory, make sure that the tests pass successfully.
          For example,
          <pre>cd trunk\jatspacks\test
perl TestValidation.pl</pre>
        </li>
        <li>
          Edit ReleaseNotes.txt.
          <ul>
            <li>
              Decide on a major/minor version number.
              Create a name for this release of the form
              "jatspan-<em>v.vv</em>", where <em>v.vv</em>
              is the version number.
            </li>
            <li>
              Add a new section at the top.  Copy the format of previous
              sections.
            </li>
            <li>
              Check the <a href='http://jatspan.svn.sourceforge.net/viewvc/jatspan/trunk/?sortby=log&amp;view=log'>Subversion
              trunk log view</a> to see commit messages.  Include
              summaries of the important ones since the last release.
            </li>
          </ul>
        </li>
        <li>
          From trunk, commit everything, with a note about the release.  E.g.
          <pre>svn commit -m "Release <em>v.vv</em>, candidate <em>1</em>"</pre>
          Increment the candidate number if this isn't the first attempt at a
          release for this version number.
        </li>

        <li>
          If this is not the first release candidate, then you'll need to delete
          the old Subversion tag for the previous attempt:
          <pre>svn del \
  https://jatspan.svn.sourceforge.net/svnroot/jatspan/releases/<em>v.vv</em> \
  -m "Deleting old tag of release <em>v.vv</em>."</pre>
        </li>

        <li>
          Create a tag in Subversion for this release, with a command similar to the
          following.
          <pre>svn copy --parents \
  https://jatspan.svn.sourceforge.net/svnroot/jatspan/trunk \
  https://jatspan.svn.sourceforge.net/svnroot/jatspan/releases/<em>v.vv</em> \
  -m "Tagging release '<em>v.vv</em>'."</pre>
          Verify that the release tag was created, by
          <a href='http://jatspan.svn.sourceforge.net/viewvc/jatspan/releases/'>checking
          the repository</a>.
          (See <a href='http://svnbook.red-bean.com/en/1.1/ch04s06.html'>this page</a>
          in the Subversion documentation for a discussion of using
          tags for releases.)  Make a note of the revision number.
        </li>
        <li>
          Create the download file.  From the trunk directory, enter a command
          similar to the following.  This uses the InfoZip's zip utility.
          <pre>zip -9r -ll jatspacks-<em>v.vv</em>.zip jatspan -x *.svn*</pre>
          <ul>
            <li>
              <em>v.vv</em> is the version number of the release.
            </li>
            <li>
              "-9" says to "compress better".
            </li>
            <li>
              "-r" means recurse into subdirectories.
            </li>
            <li>
              "-ll" causes all Windows line-endings 'CR LF' to be converted to
              Unix style 'LF'.
            </li>
            <li>
              "-x *.svn*" excludes the subversion repository directories.
            </li>
          </ul>
        </li>
        <li>
          Test one more time.  This is important to ensure
          the integrity of the release file.  It's a good idea to use a
          different machine, and try each of a Unix/Windows machine.
          <ul>
            <li>
              Unzip it to a temporary directory.
            </li>
            <li>
              Rerun the tests.
            </li>
          </ul>
        </li>
        <li>
          Rename the zip file to include the final Subversion repository
          revision.  Use the revision number that was generated when you created
          the release tag (which you can see
          <a href='http://jatspan.svn.sourceforge.net/viewvc/nlm-jats/releases/'>here</a>).
          For example,
          "jatspan-<em>1.16</em>-r<em>1024</em>.zip".
        </li>
        <li>
          Upload the Zip file to the site.  Also, if there were any changes
          to the README.txt file, upload it too, so that they are reflected on
          the Files page.
        </li>
        <li>
          From the file manager section on SF, click the "detailed info" button
          next to the newly uploaded package, and:  select it as the default
          download for all platforms, and change the button label to something
          descriptive.
        </li>
        <li>
          Add a news item announcement, from
          <a href='https://sourceforge.net/news/?group_id=333971'>this page</a>,
          and <a href='http://jatspan.org/news.html'>here</a>.
        </li>
      <!--
        <li>
        </li>
      -->
      </ol>
    </div>


  </body>
</html>